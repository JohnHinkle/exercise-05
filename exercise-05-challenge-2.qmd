---
title: "exercise-05-challenge-2"
author: "John Hinkle"
format: html
self-contained: true
editor: visual
---

## Exercise 05, Challenge 2

## Step 1: Load data

```{r}
library(tidyverse)
z <- read.csv("https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv")
```

## Step 2: Calculate the population mean and standard deviation for each quantitative random variable

```{r}
pop_sd <- function(x){
  sqrt(sum((x - mean(x))^2) / length(x))
}



print(z_summary <- 
        z |> 
        select(-id) |>
  summarise(across(where(is.numeric), list( 
    mean = ~mean(.), 
    sd = ~pop_sd(.)
    ), .names = "{.col}_{.fn}")))
```

## Step 3: Box plots of quantitative random variables by gender

```{r}
library(ggplot2)

# Height
height_boxplot <- ggplot(z, aes(x=gender, y=height)) +
  geom_boxplot(color = "#BF5700")
height_boxplot

# Weight
weight_boxplot <- ggplot(z, aes(x=gender, y=weight)) +
  geom_boxplot(color = "#BF5700")
weight_boxplot

# Zombies killed
kills_boxplot <- ggplot(z, aes(x=gender, y=zombies_killed)) +
  geom_boxplot(color = "#BF5700")
kills_boxplot

# Education
education_boxplot <- ggplot(z, aes(x=gender, y=years_of_education)) +
  geom_boxplot(color = "#BF5700")
education_boxplot

# Age
age_boxplot <- ggplot(z, aes(x=gender, y=age)) +
  geom_boxplot(color = "#BF5700")
age_boxplot

```

## Step 4: Scatter plots of height and weight vs. age

It appears that there is a positive relationship between height vs. age, and weight vs. age. As you get older, you get taller and heavier. It is worth noting that the age axis only goes from 10 years old to 30 years old.

```{r}

# Height
print(height_scatter <- ggplot(z, aes(x= age, y=height, color=gender)) +
  geom_point())

# Weight
print(weight_scatter <- ggplot(z, aes(x= age, y=weight, color=gender)) +
  geom_point())
```

## Step 5: Histograms of each random quantitative variable

'zombies_killed' and 'years_of_education' both have non-normal distributions.

```{r}
# Height
hist(z$height)
# Weight
hist(z$weight)

# Zombies killed
hist(z$zombies_killed)

# Years of education
hist(z$years_of_education)

# Age
hist(z$age)
```

## Step 6: Sample one subset of 50 survivors, calculate summary statistics and CIs for each quantitative random variable

```{r}
z_sample <- slice_sample(z, n=50)

# summary stats df
print(z_sample_summary <- 
        z_sample |> 
        select(-id) |>
  summarise(across(where(is.numeric), list( 
    mean = ~mean(.), 
    sd = ~sd(.),
    se = ~sd(.)/sqrt(length(.))
    ), .names = "{.col}_{.fn}")))

# 95% CI for height
height_ci <- z_sample_summary$height_mean + qnorm(p=c(0.025, 0.975))*z_sample_summary$height_se
cat("95% CI for height:", height_ci, "\n")

# 95% CI for weight
weight_ci <- z_sample_summary$weight_mean + qnorm(p=c(0.025, 0.975))*z_sample_summary$weight_se
cat("95% CI for weight:", weight_ci, "\n")

# 95% CI for zombies killed
kills_ci <- z_sample_summary$zombies_killed_mean + qnorm(p=c(0.025, 0.975))*z_sample_summary$zombies_killed_se
cat("95% CI for zombies killed:", kills_ci, "\n")

# 95% CI for years of education
education_ci <- z_sample_summary$years_of_education_mean + qnorm(p=c(0.025, 0.975))*z_sample_summary$years_of_education_se
cat("95% CI for years of education:", education_ci, "\n")

# # 95% CI for age
age_ci <- z_sample_summary$age_mean + qnorm(p=c(0.025, 0.975))*z_sample_summary$age_se
cat("95% CI for age:", age_ci)
```

## Step 7:

```{r}
library(mosaic)
reps <- 199
```

## Step 8:

```{r}

```

## Step 9:

```{r}

```

## Step 10:

```{r}

```
